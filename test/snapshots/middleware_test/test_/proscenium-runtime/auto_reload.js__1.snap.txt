// ../../lib/proscenium/runtime/auto_reload.js
import { createConsumer } from "/url:https%3A%2F%2Fesm.sh%2Fv96%2F%40rails%2Factioncable%407.0.4%2Fes2022%2Factioncable.js";
var auto_reload_default = (socketPath) => {
  const uid = (Date.now() + (Math.random() * 100 | 0)).toString();
  const consumer = createConsumer(`${socketPath}?uid=${uid}`);
  consumer.subscriptions.create("Proscenium::ReloadChannel", {
    received: debounce(() => {
      console.log("[Proscenium] Files changed; reloading...");
      location.reload();
    }, 200, true),
    connected() {
      console.log("[Proscenium] Auto-reload websocket connected");
    },
    disconnected() {
      console.log("[Proscenium] Auto-reload websocket disconnected");
    }
  });
};
function debounce(func, wait, immediate) {
  let timeout;
  return function() {
    const args = arguments;
    const later = () => {
      timeout = null;
      !immediate && func.apply(this, args);
    };
    const callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    callNow && func.apply(this, args);
  };
}
export {
  auto_reload_default as default
};
//# sourceMappingURL=auto_reload.js.map
